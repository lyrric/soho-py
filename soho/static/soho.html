<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>soho搜货</title>
    <script src="./js/vue.min.js"></script>
    <script src="https://unpkg.com/element-ui@2.15.14/lib/index.js"></script>
    <link
            rel="stylesheet"
            href="https://unpkg.com/element-ui@2.15.14/lib/theme-chalk/index.css"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <style>-
    body {
      margin: 0;
      padding: 0;
      background-color: #f5f7fa;
      font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    }

    .container {
      max-width: 1000px;
      margin: 40px auto;
      padding: 20px;
    }

    .app-title {
      text-align: center;
      margin-bottom: 30px;
      color: #1890ff;
      font-weight: 600;
    }

    .form-container {
      background-color: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);
      margin-bottom: 30px;
    }

    .table-container {
      background-color: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);
    }

    .el-form-item {
      margin-bottom: 20px;
    }

    .btn-submit {
      width: 100%;
    }

    .operation-buttons {
      display: flex;
      gap: 5px;
    }

    /* 动画效果 */
    .fade-enter-active, .fade-leave-active {
      transition: opacity .5s;
    }
    .fade-enter, .fade-leave-to {
      opacity: 0;
    }
    </style>
</head>
<body>
<div id="app" class="container">
    <h1 class="app-title">
        <i class="fa fa-clock-o" aria-hidden="true"></i> 产品时间管理系统
    </h1>

    <!-- 表单区域 -->
    <div class="form-container">
        <el-form ref="form" :model="form" :rules="rules" label-width="120px" size="medium">
            <el-form-item label="Product ID" prop="product_id">
                <el-input v-model="form.product_id" placeholder="请输入Product ID"></el-input>
            </el-form-item>

            <el-form-item label="Token ID" prop="token_id">
                <el-input v-model="form.token_id" placeholder="请输入Token ID"></el-input>
            </el-form-item>

            <el-form-item label="开始时间" prop="start_time">
                <el-select v-model="form.start_time" placeholder="请选择开始时间（小时）">
                    <el-option
                            v-for="hour in hours"
                            :key="hour"
                            :label="hour + ':00'"
                            :value="hour">
                    </el-option>
                </el-select>
            </el-form-item>

            <el-form-item>
                <el-button
                        type="primary"
                        @click="submitForm"
                        class="btn-submit"
                        :loading="loading">
                    <i class="fa fa-plus-circle" aria-hidden="true"></i> 新增记录
                </el-button>
            </el-form-item>
        </el-form>
    </div>

    <!-- 表格区域 -->
    <div class="table-container">
        <el-table
                :data="tableData"
                border
                stripe
                style="width: 100%"
                :loading="tableLoading">
            <el-table-column prop="id" label="ID" width="80" align="center"></el-table-column>
            <el-table-column prop="product_id" label="Product ID" align="center"></el-table-column>
            <el-table-column prop="token_id" label="Token ID" align="center"></el-table-column>
            <el-table-column
                    prop="start_time"
                    label="开始时间"
                    align="center">
                <template slot-scope="scope">{{ scope.row.start_time }}:00</template>
            </el-table-column>
            <el-table-column label="操作" align="center" width="200">
                <template slot-scope="scope">
                    <div class="operation-buttons">
                        <el-button
                                size="mini"
                                type="primary"
                                @click="handleEdit(scope.row)">
                            <i class="fa fa-pencil" aria-hidden="true"></i> 修改
                        </el-button>
                        <el-button
                                size="mini"
                                type="danger"
                                @click="handleDelete(scope.row.id)">
                            <i class="fa fa-trash" aria-hidden="true"></i> 删除
                        </el-button>
                    </div>
                </template>
            </el-table-column>
        </el-table>
    </div>

    <!-- 修改对话框 -->
    <el-dialog
            title="修改记录"
            :visible.sync="dialogVisible"
            width="500px"
            :close-on-click-modal="false">
        <el-form ref="editForm" :model="editForm" :rules="rules" label-width="120px" size="medium">
            <el-form-item label="Product ID" prop="product_id">
                <el-input v-model="editForm.product_id" placeholder="请输入Product ID"></el-input>
            </el-form-item>

            <el-form-item label="Token ID" prop="token_id">
                <el-input v-model="editForm.token_id" placeholder="请输入Token ID"></el-input>
            </el-form-item>

            <el-form-item label="开始时间" prop="start_time">
                <el-select v-model="editForm.start_time" placeholder="请选择开始时间（小时）">
                    <el-option
                            v-for="hour in hours"
                            :key="hour"
                            :label="hour + ':00'"
                            :value="hour">
                    </el-option>
                </el-select>
            </el-form-item>
        </el-form>
        <div slot="footer" class="dialog-footer">
            <el-button @click="dialogVisible = false">取消</el-button>
            <el-button type="primary" @click="submitEditForm" :loading="editLoading">确认</el-button>
        </div>
    </el-dialog>
</div>

<script>
    new Vue({
      el: '#app',
      data() {
        return {
          // 表单数据
          form: {
            product_id: '',
            token_id: '',
            start_time: ''
          },
          // 编辑表单数据
          editForm: {
            id: '',
            product_id: '',
            token_id: '',
            start_time: ''
          },
          // 表格数据
          tableData: [],
          // 小时选项
          hours: Array.from({length: 19}, (_, i) => i + 6), // 6到24
          // 对话框显示状态
          dialogVisible: false,
          // 加载状态
          loading: false,
          editLoading: false,
          tableLoading: false,
          // 表单验证规则
          rules: {
            product_id: [
              { required: true, message: '请输入Product ID', trigger: 'blur' }
            ],
            token_id: [
              { required: true, message: '请输入Token ID', trigger: 'blur' }
            ],
            start_time: [
              { required: true, message: '请选择开始时间', trigger: 'change' }
            ]
          }
        };
      },
      created() {
        // 页面加载时获取数据
        this.fetchData();
      },
      methods: {
        // 获取表格数据
        fetchData() {
          this.tableLoading = true;
          // 模拟API请求
          setTimeout(() => {
            // 实际项目中替换为真实API调用
            this.tableData = [
              { id: 1, product_id: 'PROD001', token_id: 'TOKEN001', start_time: 8 },
              { id: 2, product_id: 'PROD002', token_id: 'TOKEN002', start_time: 12 },
              { id: 3, product_id: 'PROD003', token_id: 'TOKEN003', start_time: 18 }
            ];
            this.tableLoading = false;
          }, 500);
        },

        // 提交表单（新增）
        submitForm() {
          this.$refs.form.validate((valid) => {
            if (valid) {
              this.loading = true;
              // 模拟API请求
              setTimeout(() => {
                // 实际项目中替换为真实API调用
                console.log('新增数据:', this.form);

                // 显示成功消息
                this.$message({
                  message: '新增成功',
                  type: 'success'
                });

                // 刷新页面
                window.location.reload();

                this.loading = false;
              }, 1000);
            }
          });
        },

        // 处理编辑
        handleEdit(row) {
          // 填充编辑表单
          this.editForm = { ...row };
          this.dialogVisible = true;
        },

        // 提交编辑表单
        submitEditForm() {
          this.$refs.editForm.validate((valid) => {
            if (valid) {
              this.editLoading = true;
              // 模拟API请求
              setTimeout(() => {
                // 实际项目中替换为真实API调用
                console.log('修改数据:', this.editForm);

                // 显示成功消息
                this.$message({
                  message: '修改成功',
                  type: 'success'
                });

                // 关闭对话框并刷新数据
                this.dialogVisible = false;
                this.fetchData();

                this.editLoading = false;
              }, 1000);
            }
          });
        },

        // 处理删除
        handleDelete(id) {
          this.$confirm('确定要删除这条记录吗?', '提示', {
            confirmButtonText: '确定',
            cancelButtonText: '取消',
            type: 'warning'
          }).then(() => {
            // 模拟API请求
            setTimeout(() => {
              // 实际项目中替换为真实API调用
              console.log('删除ID:', id);

              // 显示成功消息
              this.$message({
                type: 'success',
                message: '删除成功!'
              });

              // 刷新数据
              this.fetchData();
            }, 500);
          }).catch(() => {
            this.$message({
              type: 'info',
              message: '已取消删除'
            });
          });
        }
      }
    });
</script>
</body>
</html>
